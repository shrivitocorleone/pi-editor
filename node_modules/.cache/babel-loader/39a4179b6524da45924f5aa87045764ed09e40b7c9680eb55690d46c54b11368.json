{"ast":null,"code":"\"use strict\";\n\nconst vm = require(\"vm\");\nconst webIDLConversions = require(\"webidl-conversions\");\nconst {\n  CSSStyleDeclaration\n} = require(\"cssstyle\");\nconst {\n  Performance: RawPerformance\n} = require(\"w3c-hr-time\");\nconst notImplemented = require(\"./not-implemented\");\nconst {\n  installInterfaces\n} = require(\"../living/interfaces\");\nconst {\n  define,\n  mixin\n} = require(\"../utils\");\nconst Element = require(\"../living/generated/Element\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\nconst PageTransitionEvent = require(\"../living/generated/PageTransitionEvent\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst postMessage = require(\"../living/post-message\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\nconst {\n  btoa,\n  atob\n} = require(\"abab\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst documents = require(\"../living/documents.js\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Storage = require(\"../living/generated/Storage\");\nconst Selection = require(\"../living/generated/Selection\");\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst {\n  getCurrentEventHandlerValue\n} = require(\"../living/helpers/create-event-accessor.js\");\nconst {\n  fireAnEvent\n} = require(\"../living/helpers/events\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst {\n  forEachMatchingSheetRuleOfElement,\n  getResolvedValue,\n  propertiesWithResolvedValueImplemented,\n  SHADOW_DOM_PSEUDO_REGEXP\n} = require(\"../living/helpers/style-rules.js\");\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\nconst jsGlobals = require(\"./js-globals.json\");\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\nconst events = new Set([\n// GlobalEventHandlers\n\"abort\", \"autocomplete\", \"autocompleteerror\", \"blur\", \"cancel\", \"canplay\", \"canplaythrough\", \"change\", \"click\", \"close\", \"contextmenu\", \"cuechange\", \"dblclick\", \"drag\", \"dragend\", \"dragenter\", \"dragleave\", \"dragover\", \"dragstart\", \"drop\", \"durationchange\", \"emptied\", \"ended\", \"focus\", \"input\", \"invalid\", \"keydown\", \"keypress\", \"keyup\", \"load\", \"loadeddata\", \"loadedmetadata\", \"loadstart\", \"mousedown\", \"mouseenter\", \"mouseleave\", \"mousemove\", \"mouseout\", \"mouseover\", \"mouseup\", \"wheel\", \"pause\", \"play\", \"playing\", \"progress\", \"ratechange\", \"reset\", \"resize\", \"scroll\", \"securitypolicyviolation\", \"seeked\", \"seeking\", \"select\", \"sort\", \"stalled\", \"submit\", \"suspend\", \"timeupdate\", \"toggle\", \"volumechange\", \"waiting\",\n// WindowEventHandlers\n\"afterprint\", \"beforeprint\", \"hashchange\", \"languagechange\", \"message\", \"messageerror\", \"offline\", \"online\", \"pagehide\", \"pageshow\", \"popstate\", \"rejectionhandled\", \"storage\", \"unhandledrejection\", \"unload\"\n\n// \"error\" and \"beforeunload\" are added separately\n]);\n\nexports.createWindow = function (options) {\n  return new Window(options);\n};\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(_ref => {\n  let [name] = _ref;\n  return name in global;\n});\n\n// TODO remove when we drop Node v10 support.\nconst anyNodeVersionQueueMicrotask = typeof queueMicrotask === \"function\" ? queueMicrotask : process.nextTick;\n\n// https://html.spec.whatwg.org/#the-window-object\nfunction setupWindow(windowInstance, _ref2) {\n  let {\n    runScripts\n  } = _ref2;\n  if (runScripts === \"outside-only\" || runScripts === \"dangerously\") {\n    contextifyWindow(windowInstance);\n\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: vm.runInContext(globalName, windowInstance)\n      };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  } else {\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: global[globalName]\n      };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  }\n  installInterfaces(windowInstance, [\"Window\"]);\n  const EventTargetConstructor = windowInstance.EventTarget;\n\n  // eslint-disable-next-line func-name-matching, func-style, no-shadow\n  const windowConstructor = function Window() {\n    throw new TypeError(\"Illegal constructor\");\n  };\n  Object.setPrototypeOf(windowConstructor, EventTargetConstructor);\n  Object.defineProperty(windowInstance, \"Window\", {\n    configurable: true,\n    writable: true,\n    value: windowConstructor\n  });\n  const windowPrototype = Object.create(EventTargetConstructor.prototype);\n  Object.defineProperties(windowPrototype, {\n    constructor: {\n      value: windowConstructor,\n      writable: true,\n      configurable: true\n    },\n    [Symbol.toStringTag]: {\n      value: \"Window\",\n      configurable: true\n    }\n  });\n  windowConstructor.prototype = windowPrototype;\n  Object.setPrototypeOf(windowInstance, windowPrototype);\n  EventTarget.setup(windowInstance, windowInstance);\n  mixin(windowInstance, WindowEventHandlersImpl.prototype);\n  mixin(windowInstance, GlobalEventHandlersImpl.prototype);\n  windowInstance._initGlobalEvents();\n  Object.defineProperty(windowInstance, \"onbeforeunload\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"beforeunload\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnBeforeUnloadEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"beforeunload\", V);\n    }\n  });\n  Object.defineProperty(windowInstance, \"onerror\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"error\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnErrorEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"error\", V);\n    }\n  });\n  for (const event of events) {\n    Object.defineProperty(windowInstance, `on${event}`, {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, event));\n      },\n      set(V) {\n        if (!idlUtils.isObject(V)) {\n          V = null;\n        } else {\n          V = EventHandlerNonNull.convert(V, {\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\n          });\n        }\n        this._setEventHandlerFor(event, V);\n      }\n    });\n  }\n  windowInstance._globalObject = windowInstance;\n}\n\n// NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\nfunction Window(options) {\n  setupWindow(this, {\n    runScripts: options.runScripts\n  });\n  const rawPerformance = new RawPerformance();\n  const windowInitialized = rawPerformance.now();\n  const window = this;\n\n  // ### PRIVATE DATA PROPERTIES\n\n  this._resourceLoader = options.resourceLoader;\n\n  // vm initialization is deferred until script processing is activated\n  this._globalProxy = this;\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, {\n    get: () => this._globalProxy\n  });\n\n  // List options explicitly to be clear which are passed through\n  this._document = documents.createWrapper(window, {\n    parsingMode: options.parsingMode,\n    contentType: options.contentType,\n    encoding: options.encoding,\n    cookieJar: options.cookieJar,\n    url: options.url,\n    lastModified: options.lastModified,\n    referrer: options.referrer,\n    parseOptions: options.parseOptions,\n    defaultView: this._globalProxy,\n    global: this,\n    parentOrigin: options.parentOrigin\n  }, {\n    alwaysUseDocumentClass: true\n  });\n  if (vm.isContext(window)) {\n    const documentImpl = idlUtils.implForWrapper(window._document);\n    documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\n  }\n  const documentOrigin = idlUtils.implForWrapper(this._document)._origin;\n  this._origin = documentOrigin;\n\n  // https://html.spec.whatwg.org/#session-history\n  this._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(this._document),\n    url: idlUtils.implForWrapper(this._document)._URL,\n    stateObject: null\n  }, this);\n  this._virtualConsole = options.virtualConsole;\n  this._runScripts = options.runScripts;\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  this._parent = this._top = this._globalProxy;\n  this._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  this._length = 0;\n\n  // https://dom.spec.whatwg.org/#window-current-event\n  this._currentEvent = undefined;\n  this._pretendToBeVisual = options.pretendToBeVisual;\n  this._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\n    this._commonForOrigin = options.commonForOrigin;\n  } else {\n    this._commonForOrigin = {\n      [documentOrigin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [this]\n      }\n    };\n  }\n  this._currentOriginData = this._commonForOrigin[documentOrigin];\n\n  // ### WEB STORAGE\n\n  this._localStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n  this._sessionStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n\n  // ### SELECTION\n\n  // https://w3c.github.io/selection-api/#dfn-selection\n  this._selection = Selection.createImpl(window);\n\n  // https://w3c.github.io/selection-api/#dom-window\n  this.getSelection = function () {\n    return window._selection;\n  };\n\n  // ### GETTERS\n\n  const locationbar = BarProp.create(window);\n  const menubar = BarProp.create(window);\n  const personalbar = BarProp.create(window);\n  const scrollbars = BarProp.create(window);\n  const statusbar = BarProp.create(window);\n  const toolbar = BarProp.create(window);\n  const external = External.create(window);\n  const navigator = Navigator.create(window, [], {\n    userAgent: this._resourceLoader._userAgent\n  });\n  const performance = Performance.create(window, [], {\n    rawPerformance\n  });\n  const screen = Screen.create(window);\n  const customElementRegistry = CustomElementRegistry.create(window);\n  define(this, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return idlUtils.wrapperForImpl(window._frameElement);\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performance;\n    },\n    get screen() {\n      return screen;\n    },\n    get origin() {\n      return window._origin;\n    },\n    // The origin IDL attribute is defined with [Replaceable].\n    set origin(value) {\n      Object.defineProperty(this, \"origin\", {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true\n      });\n    },\n    get localStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"localStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return this._localStorage;\n    },\n    get sessionStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"sessionStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return this._sessionStorage;\n    },\n    get customElements() {\n      return customElementRegistry;\n    },\n    get event() {\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\n    },\n    set event(value) {\n      Object.defineProperty(window, \"event\", {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value\n      });\n    }\n  });\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy);\n\n  // ### METHODS\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\n\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\n  const listOfActiveTimers = new Map();\n  let latestTimerId = 0;\n  this.setTimeout = function (handler) {\n    let timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: false\n    });\n  };\n  this.setInterval = function (handler) {\n    let timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    for (var _len2 = arguments.length, args = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n      args[_key2 - 2] = arguments[_key2];\n    }\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: true\n    });\n  };\n  this.clearTimeout = function () {\n    let handle = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  this.clearInterval = function () {\n    let handle = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      // We use setTimeout() in timerInitializationSteps even for this.setInterval().\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  function timerInitializationSteps(handler, timeout, args, _ref3) {\n    let {\n      methodContext,\n      repeat,\n      previousHandle\n    } = _ref3;\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\n    if (!methodContext._document) {\n      return 0;\n    }\n\n    // TODO: implement timer nesting level behavior.\n\n    const methodContextProxy = methodContext._globalProxy;\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\n    function task() {\n      if (!listOfActiveTimers.has(handle)) {\n        return;\n      }\n      try {\n        if (typeof handler === \"function\") {\n          handler.apply(methodContextProxy, args);\n        } else if (window._runScripts === \"dangerously\") {\n          vm.runInContext(handler, window, {\n            filename: window.location.href,\n            displayErrors: false\n          });\n        }\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n      if (listOfActiveTimers.has(handle)) {\n        if (repeat) {\n          timerInitializationSteps(handler, timeout, args, {\n            methodContext,\n            repeat: true,\n            previousHandle: handle\n          });\n        } else {\n          listOfActiveTimers.delete(handle);\n        }\n      }\n    }\n    if (timeout < 0) {\n      timeout = 0;\n    }\n    const nodejsTimer = setTimeout(task, timeout);\n    listOfActiveTimers.set(handle, nodejsTimer);\n    return handle;\n  }\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\n\n  this.queueMicrotask = function (callback) {\n    callback = webIDLConversions.Function(callback);\n    anyNodeVersionQueueMicrotask(() => {\n      try {\n        callback();\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n    });\n  };\n\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\n\n  let animationFrameCallbackId = 0;\n  const mapOfAnimationFrameCallbacks = new Map();\n  let animationFrameNodejsInterval = null;\n\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\n  let numberOfOngoingAnimationFrameCallbacks = 0;\n  if (this._pretendToBeVisual) {\n    this.requestAnimationFrame = function (callback) {\n      callback = webIDLConversions.Function(callback);\n      const handle = ++animationFrameCallbackId;\n      mapOfAnimationFrameCallbacks.set(handle, callback);\n      ++numberOfOngoingAnimationFrameCallbacks;\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\n        animationFrameNodejsInterval = setInterval(() => {\n          runAnimationFrameCallbacks(rawPerformance.now() - windowInitialized);\n        }, 1000 / 60);\n      }\n      return handle;\n    };\n    this.cancelAnimationFrame = function (handle) {\n      handle = webIDLConversions[\"unsigned long\"](handle);\n      removeAnimationFrameCallback(handle);\n    };\n    function runAnimationFrameCallbacks(now) {\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\n      for (const handle of callbackHandles) {\n        // This has() can be false if a callback calls cancelAnimationFrame().\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\n          removeAnimationFrameCallback(handle);\n          try {\n            callback(now);\n          } catch (e) {\n            reportException(window, e, window.location.href);\n          }\n        }\n      }\n    }\n    function removeAnimationFrameCallback(handle) {\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\n        --numberOfOngoingAnimationFrameCallbacks;\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\n          clearInterval(animationFrameNodejsInterval);\n        }\n      }\n      mapOfAnimationFrameCallbacks.delete(handle);\n    }\n  }\n  function stopAllTimers() {\n    for (const nodejsTimer of listOfActiveTimers.values()) {\n      clearTimeout(nodejsTimer);\n    }\n    listOfActiveTimers.clear();\n    clearInterval(animationFrameNodejsInterval);\n  }\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttributeNS(null, \"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttributeNS(null, \"selected\", \"\");\n    }\n    impl._selectedness = selected;\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: this.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Image() {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n    if (arguments.length > 0) {\n      impl.setAttributeNS(null, \"width\", String(arguments.length <= 0 ? undefined : arguments[0]));\n    }\n    if (arguments.length > 1) {\n      impl.setAttributeNS(null, \"height\", String(arguments.length <= 1 ? undefined : arguments[1]));\n    }\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: this.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttributeNS(null, \"preload\", \"auto\");\n    if (src !== undefined) {\n      impl.setAttributeNS(null, \"src\", String(src));\n    }\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: this.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  this.postMessage = postMessage(window);\n  this.atob = function (str) {\n    const result = atob(str);\n    if (result === null) {\n      throw DOMException.create(window, [\"The string to be decoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n    return result;\n  };\n  this.btoa = function (str) {\n    const result = btoa(str);\n    if (result === null) {\n      throw DOMException.create(window, [\"The string to be encoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n    return result;\n  };\n  this.stop = function () {\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n  this.close = function () {\n    // Recursively close child frame windows, then ourselves (depth-first).\n    for (let i = 0; i < this.length; ++i) {\n      this[i].close();\n    }\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\n    if (this._document) {\n      if (this._document.body) {\n        this._document.body.innerHTML = \"\";\n      }\n      if (this._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\n        this._document.close();\n      }\n      const doc = idlUtils.implForWrapper(this._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete this._document;\n    }\n    stopAllTimers();\n    WebSocketImpl.cleanUpWindow(this);\n  };\n  this.getComputedStyle = function (elt) {\n    let pseudoElt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n    elt = Element.convert(elt);\n    if (pseudoElt !== undefined && pseudoElt !== null) {\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\n    }\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\n      // TODO: Parse pseudoElt\n\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\n      }\n      notImplemented(\"window.computedStyle(elt, pseudoElt)\", this);\n    }\n    const declaration = new CSSStyleDeclaration();\n    const {\n      forEach\n    } = Array.prototype;\n    const {\n      style\n    } = elt;\n    forEachMatchingSheetRuleOfElement(elt, rule => {\n      forEach.call(rule.style, property => {\n        declaration.setProperty(property, rule.style.getPropertyValue(property), rule.style.getPropertyPriority(property));\n      });\n    });\n\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\n    forEach.call(declarations, property => {\n      declaration.setProperty(property, getResolvedValue(elt, property));\n    });\n    forEach.call(style, property => {\n      declaration.setProperty(property, style.getPropertyValue(property), style.getPropertyPriority(property));\n    });\n    return declaration;\n  };\n  this.getSelection = function () {\n    return window._document.getSelection();\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  this.captureEvents = function () {};\n  this.releaseEvents = function () {};\n\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  function wrapConsoleMethod(method) {\n    return function () {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n  this.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    countReset: wrapConsoleMethod(\"countReset\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    dir: wrapConsoleMethod(\"dir\"),\n    dirxml: wrapConsoleMethod(\"dirxml\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeLog: wrapConsoleMethod(\"timeLog\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n  define(this, {\n    name: \"\",\n    status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenLeft: 0,\n    screenY: 0,\n    screenTop: 0,\n    scrollX: 0,\n    scrollY: 0,\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n\n  // ### INITIALIZATION\n\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n\n    const documentImpl = idlUtils.implForWrapper(window._document);\n    if (window.document.readyState === \"complete\") {\n      fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n        if (!documentImpl._pageShowingFlag) {\n          documentImpl._pageShowingFlag = true;\n          fireAnEvent(\"pageshow\", window, PageTransitionEvent, {\n            persisted: false\n          }, documentImpl);\n        }\n      });\n    }\n  });\n}\nfunction contextifyWindow(window) {\n  if (vm.isContext(window)) {\n    return;\n  }\n  vm.createContext(window);\n}","map":{"version":3,"names":["vm","require","webIDLConversions","CSSStyleDeclaration","Performance","RawPerformance","notImplemented","installInterfaces","define","mixin","Element","EventTarget","EventHandlerNonNull","OnBeforeUnloadEventHandlerNonNull","OnErrorEventHandlerNonNull","PageTransitionEvent","namedPropertiesWindow","postMessage","DOMException","btoa","atob","idlUtils","WebSocketImpl","implementation","BarProp","documents","External","Navigator","Screen","Storage","Selection","reportException","getCurrentEventHandlerValue","fireAnEvent","SessionHistory","forEachMatchingSheetRuleOfElement","getResolvedValue","propertiesWithResolvedValueImplemented","SHADOW_DOM_PSEUDO_REGEXP","CustomElementRegistry","jsGlobals","GlobalEventHandlersImpl","WindowEventHandlersImpl","events","Set","exports","createWindow","options","Window","jsGlobalEntriesToInstall","Object","entries","filter","_ref","name","global","anyNodeVersionQueueMicrotask","queueMicrotask","process","nextTick","setupWindow","windowInstance","_ref2","runScripts","contextifyWindow","globalName","globalPropDesc","propDesc","value","runInContext","defineProperty","EventTargetConstructor","windowConstructor","TypeError","setPrototypeOf","configurable","writable","windowPrototype","create","prototype","defineProperties","constructor","Symbol","toStringTag","setup","_initGlobalEvents","enumerable","get","tryWrapperForImpl","set","V","isObject","convert","context","_setEventHandlerFor","event","_globalObject","rawPerformance","windowInitialized","now","window","_resourceLoader","resourceLoader","_globalProxy","implForWrapper","wrapperSymbol","_document","createWrapper","parsingMode","contentType","encoding","cookieJar","url","lastModified","referrer","parseOptions","defaultView","parentOrigin","alwaysUseDocumentClass","isContext","documentImpl","_defaultView","documentOrigin","_origin","_sessionHistory","document","_URL","stateObject","_virtualConsole","virtualConsole","_runScripts","_parent","_top","_frameElement","_length","_currentEvent","undefined","_pretendToBeVisual","pretendToBeVisual","_storageQuota","storageQuota","commonForOrigin","_commonForOrigin","localStorageArea","Map","sessionStorageArea","windowsInSameOrigin","_currentOriginData","_localStorage","associatedWindow","storageArea","type","documentURI","_sessionStorage","_selection","createImpl","getSelection","locationbar","menubar","personalbar","scrollbars","statusbar","toolbar","external","navigator","userAgent","_userAgent","performance","screen","customElementRegistry","length","frameElement","wrapperForImpl","frames","self","parent","top","location","_location","history","_history","origin","localStorage","sessionStorage","customElements","initializeWindow","listOfActiveTimers","latestTimerId","setTimeout","handler","timeout","arguments","DOMString","long","_len","args","Array","_key","timerInitializationSteps","methodContext","repeat","setInterval","_len2","_key2","clearTimeout","handle","nodejsTimer","delete","clearInterval","_ref3","previousHandle","methodContextProxy","task","has","apply","filename","href","displayErrors","e","callback","Function","animationFrameCallbackId","mapOfAnimationFrameCallbacks","animationFrameNodejsInterval","numberOfOngoingAnimationFrameCallbacks","requestAnimationFrame","runAnimationFrameCallbacks","cancelAnimationFrame","removeAnimationFrameCallback","callbackHandles","keys","stopAllTimers","values","clear","Option","text","defaultSelected","selected","boolean","option","createElement","impl","setAttributeNS","_selectedness","HTMLOptionElement","Image","img","String","HTMLImageElement","Audio","src","audio","HTMLAudioElement","str","result","stop","manager","_requestManager","close","i","_eventListeners","body","innerHTML","doc","cleanUpWindow","getComputedStyle","elt","pseudoElt","test","declaration","forEach","style","rule","call","property","setProperty","getPropertyValue","getPropertyPriority","declarations","captureEvents","releaseEvents","wrapConsoleMethod","method","_len3","_key3","emit","console","assert","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeLog","timeEnd","trace","warn","notImplementedMethod","status","devicePixelRatio","innerWidth","innerHeight","outerWidth","outerHeight","pageXOffset","pageYOffset","screenX","screenLeft","screenY","screenTop","scrollX","scrollY","alert","blur","confirm","focus","moveBy","moveTo","open","print","prompt","resizeBy","resizeTo","scroll","scrollBy","scrollTo","readyState","addEventListener","_pageShowingFlag","persisted","createContext"],"sources":["D:/pi-editor/node_modules/jsdom/lib/jsdom/browser/Window.js"],"sourcesContent":["\"use strict\";\nconst vm = require(\"vm\");\nconst webIDLConversions = require(\"webidl-conversions\");\nconst { CSSStyleDeclaration } = require(\"cssstyle\");\nconst { Performance: RawPerformance } = require(\"w3c-hr-time\");\nconst notImplemented = require(\"./not-implemented\");\nconst { installInterfaces } = require(\"../living/interfaces\");\nconst { define, mixin } = require(\"../utils\");\nconst Element = require(\"../living/generated/Element\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\nconst PageTransitionEvent = require(\"../living/generated/PageTransitionEvent\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst postMessage = require(\"../living/post-message\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\nconst { btoa, atob } = require(\"abab\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst documents = require(\"../living/documents.js\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Storage = require(\"../living/generated/Storage\");\nconst Selection = require(\"../living/generated/Selection\");\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst { getCurrentEventHandlerValue } = require(\"../living/helpers/create-event-accessor.js\");\nconst { fireAnEvent } = require(\"../living/helpers/events\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst { forEachMatchingSheetRuleOfElement, getResolvedValue, propertiesWithResolvedValueImplemented,\n  SHADOW_DOM_PSEUDO_REGEXP } = require(\"../living/helpers/style-rules.js\");\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\nconst jsGlobals = require(\"./js-globals.json\");\n\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\n\nconst events = new Set([\n  // GlobalEventHandlers\n  \"abort\", \"autocomplete\",\n  \"autocompleteerror\", \"blur\",\n  \"cancel\", \"canplay\", \"canplaythrough\",\n  \"change\", \"click\",\n  \"close\", \"contextmenu\",\n  \"cuechange\", \"dblclick\",\n  \"drag\", \"dragend\",\n  \"dragenter\",\n  \"dragleave\", \"dragover\",\n  \"dragstart\", \"drop\",\n  \"durationchange\", \"emptied\",\n  \"ended\", \"focus\",\n  \"input\", \"invalid\",\n  \"keydown\", \"keypress\",\n  \"keyup\", \"load\", \"loadeddata\",\n  \"loadedmetadata\", \"loadstart\",\n  \"mousedown\", \"mouseenter\",\n  \"mouseleave\", \"mousemove\",\n  \"mouseout\", \"mouseover\",\n  \"mouseup\", \"wheel\",\n  \"pause\", \"play\",\n  \"playing\", \"progress\",\n  \"ratechange\", \"reset\",\n  \"resize\", \"scroll\",\n  \"securitypolicyviolation\",\n  \"seeked\", \"seeking\",\n  \"select\", \"sort\", \"stalled\",\n  \"submit\", \"suspend\",\n  \"timeupdate\", \"toggle\",\n  \"volumechange\", \"waiting\",\n\n  // WindowEventHandlers\n  \"afterprint\",\n  \"beforeprint\",\n  \"hashchange\",\n  \"languagechange\",\n  \"message\",\n  \"messageerror\",\n  \"offline\",\n  \"online\",\n  \"pagehide\",\n  \"pageshow\",\n  \"popstate\",\n  \"rejectionhandled\",\n  \"storage\",\n  \"unhandledrejection\",\n  \"unload\"\n\n  // \"error\" and \"beforeunload\" are added separately\n]);\n\nexports.createWindow = function (options) {\n  return new Window(options);\n};\n\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name in global);\n\n// TODO remove when we drop Node v10 support.\nconst anyNodeVersionQueueMicrotask = typeof queueMicrotask === \"function\" ? queueMicrotask : process.nextTick;\n\n// https://html.spec.whatwg.org/#the-window-object\nfunction setupWindow(windowInstance, { runScripts }) {\n  if (runScripts === \"outside-only\" || runScripts === \"dangerously\") {\n    contextifyWindow(windowInstance);\n\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = { ...globalPropDesc, value: vm.runInContext(globalName, windowInstance) };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  } else {\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = { ...globalPropDesc, value: global[globalName] };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  }\n\n  installInterfaces(windowInstance, [\"Window\"]);\n\n  const EventTargetConstructor = windowInstance.EventTarget;\n\n  // eslint-disable-next-line func-name-matching, func-style, no-shadow\n  const windowConstructor = function Window() {\n    throw new TypeError(\"Illegal constructor\");\n  };\n  Object.setPrototypeOf(windowConstructor, EventTargetConstructor);\n\n  Object.defineProperty(windowInstance, \"Window\", {\n    configurable: true,\n    writable: true,\n    value: windowConstructor\n  });\n\n  const windowPrototype = Object.create(EventTargetConstructor.prototype);\n  Object.defineProperties(windowPrototype, {\n    constructor: {\n      value: windowConstructor,\n      writable: true,\n      configurable: true\n    },\n    [Symbol.toStringTag]: {\n      value: \"Window\",\n      configurable: true\n    }\n  });\n\n  windowConstructor.prototype = windowPrototype;\n  Object.setPrototypeOf(windowInstance, windowPrototype);\n\n  EventTarget.setup(windowInstance, windowInstance);\n  mixin(windowInstance, WindowEventHandlersImpl.prototype);\n  mixin(windowInstance, GlobalEventHandlersImpl.prototype);\n  windowInstance._initGlobalEvents();\n\n  Object.defineProperty(windowInstance, \"onbeforeunload\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"beforeunload\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnBeforeUnloadEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"beforeunload\", V);\n    }\n  });\n\n  Object.defineProperty(windowInstance, \"onerror\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"error\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnErrorEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"error\", V);\n    }\n  });\n\n  for (const event of events) {\n    Object.defineProperty(windowInstance, `on${event}`, {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, event));\n      },\n      set(V) {\n        if (!idlUtils.isObject(V)) {\n          V = null;\n        } else {\n          V = EventHandlerNonNull.convert(V, {\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\n          });\n        }\n        this._setEventHandlerFor(event, V);\n      }\n    });\n  }\n\n  windowInstance._globalObject = windowInstance;\n}\n\n// NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\nfunction Window(options) {\n  setupWindow(this, { runScripts: options.runScripts });\n\n  const rawPerformance = new RawPerformance();\n  const windowInitialized = rawPerformance.now();\n\n  const window = this;\n\n  // ### PRIVATE DATA PROPERTIES\n\n  this._resourceLoader = options.resourceLoader;\n\n  // vm initialization is deferred until script processing is activated\n  this._globalProxy = this;\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, { get: () => this._globalProxy });\n\n  // List options explicitly to be clear which are passed through\n  this._document = documents.createWrapper(window, {\n    parsingMode: options.parsingMode,\n    contentType: options.contentType,\n    encoding: options.encoding,\n    cookieJar: options.cookieJar,\n    url: options.url,\n    lastModified: options.lastModified,\n    referrer: options.referrer,\n    parseOptions: options.parseOptions,\n    defaultView: this._globalProxy,\n    global: this,\n    parentOrigin: options.parentOrigin\n  }, { alwaysUseDocumentClass: true });\n\n  if (vm.isContext(window)) {\n    const documentImpl = idlUtils.implForWrapper(window._document);\n    documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\n  }\n\n  const documentOrigin = idlUtils.implForWrapper(this._document)._origin;\n  this._origin = documentOrigin;\n\n  // https://html.spec.whatwg.org/#session-history\n  this._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(this._document),\n    url: idlUtils.implForWrapper(this._document)._URL,\n    stateObject: null\n  }, this);\n\n  this._virtualConsole = options.virtualConsole;\n\n  this._runScripts = options.runScripts;\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  this._parent = this._top = this._globalProxy;\n  this._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  this._length = 0;\n\n  // https://dom.spec.whatwg.org/#window-current-event\n  this._currentEvent = undefined;\n\n  this._pretendToBeVisual = options.pretendToBeVisual;\n  this._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\n    this._commonForOrigin = options.commonForOrigin;\n  } else {\n    this._commonForOrigin = {\n      [documentOrigin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [this]\n      }\n    };\n  }\n\n  this._currentOriginData = this._commonForOrigin[documentOrigin];\n\n  // ### WEB STORAGE\n\n  this._localStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n  this._sessionStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n\n  // ### SELECTION\n\n  // https://w3c.github.io/selection-api/#dfn-selection\n  this._selection = Selection.createImpl(window);\n\n  // https://w3c.github.io/selection-api/#dom-window\n  this.getSelection = function () {\n    return window._selection;\n  };\n\n  // ### GETTERS\n\n  const locationbar = BarProp.create(window);\n  const menubar = BarProp.create(window);\n  const personalbar = BarProp.create(window);\n  const scrollbars = BarProp.create(window);\n  const statusbar = BarProp.create(window);\n  const toolbar = BarProp.create(window);\n  const external = External.create(window);\n  const navigator = Navigator.create(window, [], { userAgent: this._resourceLoader._userAgent });\n  const performance = Performance.create(window, [], { rawPerformance });\n  const screen = Screen.create(window);\n  const customElementRegistry = CustomElementRegistry.create(window);\n\n  define(this, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return idlUtils.wrapperForImpl(window._frameElement);\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performance;\n    },\n    get screen() {\n      return screen;\n    },\n    get origin() {\n      return window._origin;\n    },\n    // The origin IDL attribute is defined with [Replaceable].\n    set origin(value) {\n      Object.defineProperty(this, \"origin\", {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true\n      });\n    },\n    get localStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\n          \"localStorage is not available for opaque origins\",\n          \"SecurityError\"\n        ]);\n      }\n\n      return this._localStorage;\n    },\n    get sessionStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\n          \"sessionStorage is not available for opaque origins\",\n          \"SecurityError\"\n        ]);\n      }\n\n      return this._sessionStorage;\n    },\n    get customElements() {\n      return customElementRegistry;\n    },\n    get event() {\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\n    },\n    set event(value) {\n      Object.defineProperty(window, \"event\", { configurable: true, enumerable: true, writable: true, value });\n    }\n  });\n\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy);\n\n  // ### METHODS\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\n\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\n  const listOfActiveTimers = new Map();\n  let latestTimerId = 0;\n\n  this.setTimeout = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: false });\n  };\n  this.setInterval = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: true });\n  };\n\n  this.clearTimeout = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  this.clearInterval = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      // We use setTimeout() in timerInitializationSteps even for this.setInterval().\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n\n  function timerInitializationSteps(handler, timeout, args, { methodContext, repeat, previousHandle }) {\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\n    if (!methodContext._document) {\n      return 0;\n    }\n\n    // TODO: implement timer nesting level behavior.\n\n    const methodContextProxy = methodContext._globalProxy;\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\n\n    function task() {\n      if (!listOfActiveTimers.has(handle)) {\n        return;\n      }\n\n      try {\n        if (typeof handler === \"function\") {\n          handler.apply(methodContextProxy, args);\n        } else if (window._runScripts === \"dangerously\") {\n          vm.runInContext(handler, window, { filename: window.location.href, displayErrors: false });\n        }\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n\n      if (listOfActiveTimers.has(handle)) {\n        if (repeat) {\n          timerInitializationSteps(handler, timeout, args, { methodContext, repeat: true, previousHandle: handle });\n        } else {\n          listOfActiveTimers.delete(handle);\n        }\n      }\n    }\n\n    if (timeout < 0) {\n      timeout = 0;\n    }\n\n    const nodejsTimer = setTimeout(task, timeout);\n    listOfActiveTimers.set(handle, nodejsTimer);\n\n    return handle;\n  }\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\n\n  this.queueMicrotask = function (callback) {\n    callback = webIDLConversions.Function(callback);\n\n    anyNodeVersionQueueMicrotask(() => {\n      try {\n        callback();\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n    });\n  };\n\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\n\n  let animationFrameCallbackId = 0;\n  const mapOfAnimationFrameCallbacks = new Map();\n  let animationFrameNodejsInterval = null;\n\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\n  let numberOfOngoingAnimationFrameCallbacks = 0;\n\n  if (this._pretendToBeVisual) {\n    this.requestAnimationFrame = function (callback) {\n      callback = webIDLConversions.Function(callback);\n\n      const handle = ++animationFrameCallbackId;\n      mapOfAnimationFrameCallbacks.set(handle, callback);\n\n      ++numberOfOngoingAnimationFrameCallbacks;\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\n        animationFrameNodejsInterval = setInterval(() => {\n          runAnimationFrameCallbacks(rawPerformance.now() - windowInitialized);\n        }, 1000 / 60);\n      }\n\n      return handle;\n    };\n\n    this.cancelAnimationFrame = function (handle) {\n      handle = webIDLConversions[\"unsigned long\"](handle);\n\n      removeAnimationFrameCallback(handle);\n    };\n\n    function runAnimationFrameCallbacks(now) {\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\n      for (const handle of callbackHandles) {\n        // This has() can be false if a callback calls cancelAnimationFrame().\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\n          removeAnimationFrameCallback(handle);\n          try {\n            callback(now);\n          } catch (e) {\n            reportException(window, e, window.location.href);\n          }\n        }\n      }\n    }\n\n    function removeAnimationFrameCallback(handle) {\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\n        --numberOfOngoingAnimationFrameCallbacks;\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\n          clearInterval(animationFrameNodejsInterval);\n        }\n      }\n\n      mapOfAnimationFrameCallbacks.delete(handle);\n    }\n  }\n\n  function stopAllTimers() {\n    for (const nodejsTimer of listOfActiveTimers.values()) {\n      clearTimeout(nodejsTimer);\n    }\n    listOfActiveTimers.clear();\n\n    clearInterval(animationFrameNodejsInterval);\n  }\n\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttributeNS(null, \"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttributeNS(null, \"selected\", \"\");\n    }\n    impl._selectedness = selected;\n\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: this.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Image(...args) {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n\n    if (args.length > 0) {\n      impl.setAttributeNS(null, \"width\", String(args[0]));\n    }\n    if (args.length > 1) {\n      impl.setAttributeNS(null, \"height\", String(args[1]));\n    }\n\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: this.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttributeNS(null, \"preload\", \"auto\");\n\n    if (src !== undefined) {\n      impl.setAttributeNS(null, \"src\", String(src));\n    }\n\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: this.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  this.postMessage = postMessage(window);\n\n  this.atob = function (str) {\n    const result = atob(str);\n    if (result === null) {\n      throw DOMException.create(window, [\n        \"The string to be decoded contains invalid characters.\",\n        \"InvalidCharacterError\"\n      ]);\n    }\n    return result;\n  };\n\n  this.btoa = function (str) {\n    const result = btoa(str);\n    if (result === null) {\n      throw DOMException.create(window, [\n        \"The string to be encoded contains invalid characters.\",\n        \"InvalidCharacterError\"\n      ]);\n    }\n    return result;\n  };\n\n  this.stop = function () {\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n\n  this.close = function () {\n    // Recursively close child frame windows, then ourselves (depth-first).\n    for (let i = 0; i < this.length; ++i) {\n      this[i].close();\n    }\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\n\n    if (this._document) {\n      if (this._document.body) {\n        this._document.body.innerHTML = \"\";\n      }\n\n      if (this._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\n        this._document.close();\n      }\n      const doc = idlUtils.implForWrapper(this._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete this._document;\n    }\n\n    stopAllTimers();\n    WebSocketImpl.cleanUpWindow(this);\n  };\n\n  this.getComputedStyle = function (elt, pseudoElt = undefined) {\n    elt = Element.convert(elt);\n    if (pseudoElt !== undefined && pseudoElt !== null) {\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\n    }\n\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\n      // TODO: Parse pseudoElt\n\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\n      }\n\n      notImplemented(\"window.computedStyle(elt, pseudoElt)\", this);\n    }\n\n    const declaration = new CSSStyleDeclaration();\n    const { forEach } = Array.prototype;\n    const { style } = elt;\n\n    forEachMatchingSheetRuleOfElement(elt, rule => {\n      forEach.call(rule.style, property => {\n        declaration.setProperty(\n          property,\n          rule.style.getPropertyValue(property),\n          rule.style.getPropertyPriority(property)\n        );\n      });\n    });\n\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\n    forEach.call(declarations, property => {\n      declaration.setProperty(property, getResolvedValue(elt, property));\n    });\n\n    forEach.call(style, property => {\n      declaration.setProperty(property, style.getPropertyValue(property), style.getPropertyPriority(property));\n    });\n\n    return declaration;\n  };\n\n  this.getSelection = function () {\n    return window._document.getSelection();\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  this.captureEvents = function () {};\n\n  this.releaseEvents = function () {};\n\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n\n  this.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    countReset: wrapConsoleMethod(\"countReset\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    dir: wrapConsoleMethod(\"dir\"),\n    dirxml: wrapConsoleMethod(\"dirxml\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeLog: wrapConsoleMethod(\"timeLog\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n\n  define(this, {\n    name: \"\",\n    status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenLeft: 0,\n    screenY: 0,\n    screenTop: 0,\n    scrollX: 0,\n    scrollY: 0,\n\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n\n  // ### INITIALIZATION\n\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n\n    const documentImpl = idlUtils.implForWrapper(window._document);\n\n    if (window.document.readyState === \"complete\") {\n      fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n\n        if (!documentImpl._pageShowingFlag) {\n          documentImpl._pageShowingFlag = true;\n          fireAnEvent(\"pageshow\", window, PageTransitionEvent, { persisted: false }, documentImpl);\n        }\n      });\n    }\n  });\n}\n\nfunction contextifyWindow(window) {\n  if (vm.isContext(window)) {\n    return;\n  }\n\n  vm.createContext(window);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}